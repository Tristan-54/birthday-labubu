<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»˜æ—ç”Ÿæ—¥æŠ½æŠ½ä¹</title>
    <!-- å¼•å…¥ Tailwind CSS è¿›è¡Œå¿«é€Ÿæ ·å¼è®¾è®¡ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥å½©å¸¦ç‰¹æ•ˆåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        /* è‡ªå®šä¹‰å¯çˆ±å­—ä½“ */
        @import url('https://fonts.googleapis.com/css2?family=Zcool+KuaiLe&display=swap');
        
        body {
            font-family: 'Zcool KuaiLe', cursive, sans-serif;
            background-color: #fce7f3; /* æµ…ç²‰è‰²èƒŒæ™¯ */
            background-image: radial-gradient(#fbcfe8 2px, transparent 2px);
            background-size: 20px 20px;
        }

        /* ç›²ç›’æ‘‡æ™ƒåŠ¨ç”» */
        @keyframes shake {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            50% { transform: rotate(0eg); }
            75% { transform: rotate(-5deg); }
            100% { transform: rotate(0deg); }
        }
        
        .box-card:hover {
            animation: shake 0.5s infinite;
            cursor: pointer;
        }

        /* å¼¹çª—åŠ¨ç”» */
        .modal-enter {
            animation: popIn 0.3s ease-out forwards;
        }
        
        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .prize-icon svg {
            width: 80px;
            height: 80px;
            margin: 0 auto;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-8">

    <!-- 1. é¡¶éƒ¨åº†ç¥åŒºåŸŸ -->
    <header class="text-center mb-8 w-full px-4">
        <!-- è¿™é‡Œå»ºè®®æ›¿æ¢ä¸ºä½ æ‰¾åˆ°çš„ä¸€ç¾¤ Labubu çš„å›¾ç‰‡ URL -->
        <div class="w-full max-w-md mx-auto rounded-xl overflow-hidden shadow-lg mb-4 bg-white border-4 border-pink-400">
            <img src="https://placehold.co/600x300/ffb6c1/ffffff?text=Happy+Birthday!+Labubu+Party" 
                 alt="Labubu Celebration" 
                 class="w-full h-48 object-cover"
                 id="hero-image">
        </div>
        <h1 class="text-4xl text-pink-600 font-bold drop-shadow-md">âœ¨ ä»˜æ—ç”Ÿæ—¥æŠ½æŠ½ä¹ âœ¨</h1>
        <p class="text-gray-600 mt-2">é€‰ä¸€ä¸ªç›²ç›’ï¼Œæ‰«ææ”¯ä»˜å¼€å¯æƒŠå–œï½</p>
    </header>

    <!-- 2. å…­ä¸ªæ ¼å­çš„æŠ½å¥–åŒºåŸŸ -->
    <main class="grid grid-cols-2 md:grid-cols-3 gap-6 max-w-2xl px-4 w-full" id="box-container">
        <!-- ç›’å­ä¼šé€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
    </main>

    <!-- 3. æ”¯ä»˜å¼¹çª— (é»˜è®¤éšè—) -->
    <div id="pay-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-[90%] text-center shadow-2xl modal-enter border-4 border-green-400">
            <h3 class="text-2xl text-gray-800 mb-4">ğŸ å¼€å¯è¿™ä¸ªç›²ç›’</h3>
            <p class="text-gray-500 mb-4">è¯·æ‰«æä¸‹æ–¹äºŒç»´ç æ”¯ä»˜ <span class="text-red-500 font-bold">Â¥49</span></p>
            
            <!-- æ”¯ä»˜äºŒç»´ç å›¾ç‰‡å ä½ç¬¦ -->
            <div class="bg-gray-100 p-4 rounded-lg mb-4 inline-block">
                <!-- è¯·æ›¿æ¢ä¸‹é¢çš„ src ä¸ºä½ çš„å¾®ä¿¡æ”¶æ¬¾ç å›¾ç‰‡ -->
                <img src="https://placehold.co/200x200/22c55e/ffffff?text=WeChat+Pay" 
                     alt="æ”¯ä»˜äºŒç»´ç " 
                     class="w-48 h-48 object-contain">
            </div>
            
            <p class="text-xs text-gray-400 mb-4">*æ”¯ä»˜é‡‘é¢ä¸éšæ„ï¼Œå¼€å¿ƒå°±å¥½áƒš(Â°â—•â€µÆ¹â€²â—•áƒš)*</p>
            
            <!-- æŒ‰é’®åŒºåŸŸ -->
            <div class="flex justify-center gap-4">
                <!-- 1. â€œå¦‚ç®—â€æŒ‰é’®ï¼šç‚¹å‡»åè§¦å‘ refuseAction()ï¼Œä¸å…³é—­å¼¹çª— -->
                <button onclick="refuseAction()" class="px-4 py-2 rounded-full bg-gray-200 text-gray-600 hover:bg-gray-300 transition">
                    å¦‚ç®—
                </button>
                
                <!-- 2. â€œæˆ‘å·²æ”¯ä»˜â€æŒ‰é’®ï¼šç‚¹å‡»è§¦å‘ handlePayment()ï¼Œå¸¦æ¨¡æ‹Ÿäº¤äº’ -->
                <button id="btn-pay" onclick="handlePayment()" class="px-6 py-2 rounded-full bg-green-500 text-white font-bold hover:bg-green-600 shadow-lg transition flex items-center">
                    <span>æˆ‘å·²æ”¯ä»˜</span>
                    <!-- è¿™é‡Œè—äº†ä¸€ä¸ªåŠ è½½åœˆï¼Œé»˜è®¤éšè— -->
                    <svg id="loading-icon" class="animate-spin ml-2 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- 4. å¥–å“å±•ç¤ºå¼¹çª— (é»˜è®¤éšè—) -->
    <div id="prize-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-[90%] text-center shadow-2xl modal-enter relative overflow-hidden border-8 border-pink-300">
            <!-- èƒŒæ™¯è£…é¥° -->
            <div class="absolute top-0 left-0 w-full h-4 bg-pink-300"></div>
            
            <h2 class="text-3xl text-pink-500 mb-6 font-bold">ğŸ‰ æ­å–œè·å¾— ğŸ‰</h2>
            
            <!-- å¥–å“å†…å®¹å±•ç¤ºåŒº -->
            <div id="prize-content" class="mb-8">
                <div class="prize-icon text-pink-400 mb-4" id="prize-icon-container">
                    <!-- SVGå›¾æ ‡å°†æ’å…¥è¿™é‡Œ -->
                </div>
                <div class="text-2xl text-gray-800 font-bold" id="prize-name">å¥–å“åç§°</div>
                <div class="text-sm text-gray-500 mt-2">ï¼ˆå‡­å€Ÿæˆªå›¾æ‰¾æˆ‘å…‘æ¢å“¦å®è§~ï¼‰</div>
            </div>

            <button onclick="closeModal('prize-modal')" class="w-full py-3 rounded-xl bg-pink-500 text-white font-bold text-lg hover:bg-pink-600 shadow-lg transition">æ”¶ä¸‹ç¤¼ç‰© â¤ï¸</button>
        </div>
    </div>

    <script>
        // å®šä¹‰å¥–å“æ•°æ®ï¼ˆåŒ…å« SVG ç®€ç¬”ç”»ï¼‰
        const prizes = [
            { 
                name: "ç¾ä¸½çš„é²œèŠ± ğŸ’", 
                svg: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 7.5a4.5 4.5 0 1 1 4.5 4.5M12 7.5A4.5 4.5 0 1 0 7.5 12M12 7.5V9m-4.5 3a4.5 4.5 0 1 0 4.5 4.5M7.5 12H9m3 0a4.5 4.5 0 1 1-4.5 4.5M12 12v2.25m-4.5 2.25a4.5 4.5 0 1 0 4.5 4.5M7.5 16.5H9m3 0a4.5 4.5 0 1 1 4.5-4.5M12 16.5V19m0-19L12 21"/></svg>`
            },
            { 
                name: "ç¾å‘³è›‹ç³• ğŸ‚", 
                svg: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8"/><path d="M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1"/><path d="M2 21h20"/><path d="M7 8v2"/><path d="M12 8v2"/><path d="M17 8v2"/><path d="M7 4h.01"/><path d="M12 4h.01"/><path d="M17 4h.01"/></svg>`
            },
            { 
                name: "ç°é‡‘çº¢åŒ… 100å…ƒ ğŸ§§", 
                svg: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="6" width="20" height="12" rx="2"/><circle cx="12" cy="12" r="2"/><path d="M6 12h.01M18 12h.01"/></svg>`
            },
            { 
                name: "æˆ‘çš„ä½“é¦™ ğŸ§´", 
                svg: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 12h4"/><path d="M12 12v6"/><path d="M7 21h10a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2z"/><path d="M9 7V5a3 3 0 0 1 6 0v2"/></svg>`
            },
            { 
                name: "æ‰‹å†™ä¿¡ä¸€å° ğŸ’Œ", 
                svg: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>`
            },
            { 
                name: "å…»ç”Ÿæ³¡è„šæ¡¶ ğŸ¦¶", 
                svg: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 10h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V10z"/><path d="M4 14h16"/><path d="M2 10h20"/><path d="M7 5a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v5H7V5z"/><path d="M8 18v2"/><path d="M16 18v2"/></svg>`
            }
        ];

        let currentPrizeIndex = null;
        let shuffledPrizes = [];

        // æ´—ç‰Œç®—æ³•
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        // åˆå§‹åŒ–é¡µé¢
        function init() {
            const container = document.getElementById('box-container');
            container.innerHTML = ''; // æ¸…ç©º
            
            // å¤åˆ¶å¹¶æ‰“ä¹±å¥–å“
            shuffledPrizes = shuffle([...prizes]);

            // ç”Ÿæˆ6ä¸ªç›’å­
            shuffledPrizes.forEach((prize, index) => {
                const box = document.createElement('div');
                box.className = "box-card bg-white rounded-2xl p-4 shadow-lg flex flex-col items-center justify-center h-40 border-b-4 border-r-4 border-pink-200 active:border-0 active:translate-y-1 transition-all";
                // è¿™é‡Œç”¨ CSS ç”Ÿæˆäº†ä¸€ä¸ªç®€å•çš„ Labubu ç›²ç›’å°é¢ç¤ºæ„å›¾
                // å¦‚æœä½ æœ‰ Labubu çš„ä¸åŒè¡¨æƒ…å›¾ç‰‡ï¼Œå¯ä»¥ç”¨ <img src='...'> æ›¿æ¢ä¸‹é¢çš„å†…å®¹
                box.innerHTML = `
                    <div class="text-5xl mb-2">ğŸ‘¾</div>
                    <div class="font-bold text-pink-500">ç›²ç›’ No.${index + 1}</div>
                    <div class="text-xs text-gray-400 mt-1">ç‚¹å‡»å¼€å¯</div>
                `;
                
                box.onclick = () => openPayModal(index);
                container.appendChild(box);
            });
        }

        // æ‰“å¼€æ”¯ä»˜å¼¹çª—
        function openPayModal(index) {
            currentPrizeIndex = index;
            document.getElementById('pay-modal').classList.remove('hidden');
        }

        // ç¡®è®¤æ”¯ä»˜ï¼ˆæ¨¡æ‹Ÿï¼‰
        function confirmPayment() {
            closeModal('pay-modal');
            
            // æ¨¡æ‹Ÿ loading æˆ–è€…ç›´æ¥å±•ç¤ºç»“æœ
            setTimeout(() => {
                showPrize();
            }, 300);
        }

        // å±•ç¤ºå¥–å“
        function showPrize() {
            const prize = shuffledPrizes[currentPrizeIndex];
            
            // å¡«å……æ•°æ®
            document.getElementById('prize-name').textContent = prize.name;
            document.getElementById('prize-icon-container').innerHTML = prize.svg;
            
            // æ˜¾ç¤ºå¼¹çª—
            document.getElementById('prize-modal').classList.remove('hidden');

            // æ’­æ”¾å½©å¸¦ç‰¹æ•ˆ
            triggerConfetti();
        }

        // å…³é—­å¼¹çª—
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // å½©å¸¦ç‰¹æ•ˆå‡½æ•°
        function triggerConfetti() {
            const duration = 3 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 60 };

            function random(min, max) { return Math.random() * (max - min) + min; }

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) { return clearInterval(interval); }
                const particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }

        // 1. â€œå¦‚ç®—â€æŒ‰é’®çš„é€»è¾‘ï¼šä¹Ÿå°±æ˜¯ä¸å‡†èµ°ï¼
        function refuseAction() {
            // éœ‡åŠ¨ä¸€ä¸‹æ‰‹æœºï¼ˆéƒ¨åˆ†æ‰‹æœºæ”¯æŒï¼‰
            if (navigator.vibrate) {
                navigator.vibrate(200);
            }
            // å¼¹å‡ºæç¤ºï¼Œä¸å…³é—­çª—å£
            alert("ä¸å¯ä»¥ç®—äº†ï¼\næ¥éƒ½æ¥äº†ï¼Œå“ªæœ‰ä¸æŠ½çš„é“ç†ï¼ŸğŸ˜¤\nï¼ˆå¿…é¡»æ”¯ä»˜æ‰èƒ½èµ°ï¼ï¼‰");
        }

        // 2. â€œæˆ‘å·²æ”¯ä»˜â€çš„é€»è¾‘ï¼šæ¨¡æ‹ŸçœŸå®çš„å¾®ä¿¡äº¤äº’æ„Ÿ
        function handlePayment() {
            const btn = document.getElementById('btn-pay');
            const icon = document.getElementById('loading-icon');
            const text = btn.querySelector('span');

            // 1. æ”¹å˜æŒ‰é’®çŠ¶æ€ï¼šæ˜¾ç¤ºè½¬åœˆåœˆï¼Œæ–‡å­—å˜æˆâ€œæ­£åœ¨éªŒè¯...â€
            btn.disabled = true; // é˜²æ­¢é‡å¤ç‚¹å‡»
            icon.classList.remove('hidden'); // æ˜¾ç¤ºè½¬åœˆ
            text.textContent = "æ­£åœ¨è¿æ¥å¾®ä¿¡éªŒè¯..."; // å‡è£…åœ¨è”ç½‘
            btn.classList.replace('bg-green-500', 'bg-green-600');

            // 2. æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿï¼ˆ3ç§’åæ‰æˆåŠŸï¼‰
            setTimeout(() => {
                // éªŒè¯æˆåŠŸï¼
                closeModal('pay-modal'); // å…³é—­å¼¹çª—
                showPrize(); // å¼€å¥–

                // 3. é‡ç½®æŒ‰é’®ï¼ˆä¸ºäº†ä¸‹æ¬¡è¿˜èƒ½ç”¨ï¼‰
                setTimeout(() => {
                    btn.disabled = false;
                    icon.classList.add('hidden');
                    text.textContent = "æˆ‘å·²æ”¯ä»˜";
                    btn.classList.replace('bg-green-600', 'bg-green-500');
                }, 1000);
                
            }, 3000); // è¿™é‡Œçš„ 3000 ä»£è¡¨ 3ç§’ï¼Œä½ å¯ä»¥è‡ªå·±æ”¹é•¿çŸ­
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = init;

    </script>
</body>
</html>